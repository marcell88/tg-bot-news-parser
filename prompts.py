# Константы для промптов, используемых в запросах к Large Language Models (LLM).
from typing import Dict, Any




# --- 1. ПЕРВАЯ ФИЛЬТРАЦИЯ - убираем плохие темы

FILTER_INITIAL = """

Промпт для фильтрации новостей

Задача: Проанализируй текст новости и определи, нужно ли её фильтровать (отклонять) на основе строгих критериев.

КРИТЕРИИ ФИЛЬТРАЦИИ (ЗАПРЕТНЫЕ ТЕМЫ):

Если новость НЕПОСРЕДСТВЕННО И В ЯВНОМ ВИДЕ посвящена или подробно описывает хотя бы одну из следующих тем, она должна быть отклонена.

Категория А: Трагедии и насилие
1. Гибель людей или травмы: Конкретные репортажи о случаях с смертельным исходом или получением физических травм. Исключение: Общие статьи о мерах безопасности, успехах медицины без упоминания конкретных жертв.
2. Смерть или страдание животных: Новости о преднамеренном убийстве, жестоком обращении, мучениях или гибели животных. Исключение: Новости о защите прав животных или научных открытиях без описания страданий.
3. Совершение или подготовка террористического акта: Сообщения о конкретных совершенных, предотвращенных или готовящихся терактах. Исключение: Общая аналитика по борьбе с терроризмом без деталей конкретных инцидентов.
4. Изнасилование или покушение на изнасилование: Подробные отчеты о конкретных преступлениях или судебных процессах по ним.
5. Риск жизни или здоровью для уязвимых групп: Конкретные сообщения о ситуациях, где жизни детей, беременных, инвалидов или стариков угрожает непосредственная опасность.
6. Природные и техногенные катастрофы: Репортажи с мест катастроф (землетрясения, наводнения, аварии на производствах) с описанием разрушений, эвакуации и жертв.
7. Авиапроисшествия и ДТП с жертвами: Новости о конкретных инцидентах, где есть погибшие или раненые.

Категория Б: Военная тематика и последствия
8. Сводки о текущих боевых действиях: Оперативные отчеты с линии фронта, тактические описания боев.
9. Страдания мирного населения на войне: Репортажи о гибели, ранениях, лишениях и гуманитарных кризисах среди гражданского населения в зонах конфликтов.
10. Проблемы ветеранов со здоровьем: Подробные истории о тяжелых физических и психологических травмах (ПТСР, ампутации), полученных в ходе боевых действий.
11. Последствия атак с жертвами: Описание результатов ракетных, артиллерийских или иных атак с акцентом на человеческие жертвы и разрушения.
12. Атаки беспилотников (БПЛА, дроны): Новости о конкретных атаках с применением дронов, их последствиях или сбитии.
13. Военные диверсии и их последствия: Сообщения о подрывах, саботаже и их результатах.

Категория В: Социально-чувствительные темы
14. Аборты: Новости, напрямую посвященные практике абортов, законодательным изменениям по их регулированию или акциям за/против.
15. Чечня и семья Кадыровых: Новости, где Чеченская Республика ИЛИ члены семьи Кадыровых являются главной и центральной темой материала. Исключение: Краткие упоминания в контексте федеральной политики или экономики.
16. ЛГБТ-пропаганда: Материалы, открыто пропагандирующие или позитивно освещающие ЛГБТ-отношения и ценности. Исключение: Критические или нейтральные упоминания в контексте закона.
17. Педофилия и порнография: Репортажи о конкретных преступлениях сексуального характера против несовершеннолетних или материалы, связанные с детской порнографией.
18. Оскорбление религиозных чувств: Новости о конкретных актах осквернения религиозных символов, мест поклонения или издевательствах над верованиями.
19. Обманы мошенниками: Конкретные репортажи о случаях мошенничества с подробным описанием ущерба, особенно для пожилых. Исключение: Общие предупреждения от банков или силовых структур без деталей конкретного инцидента.

ДОПОЛНИТЕЛЬНЫЕ КРИТЕРИИ ФИЛЬТРАЦИИ (по формату и содержанию):

Даже если новость не попадает под запретные темы выше, отклони её, если она представляет собой:
1. Рекламные и маркетинговые материалы, откровенный пиар.
2. Дайджесты новостей (сводки из нескольких новостей).
3. Сухие информационные сводки: Краткие сообщения о ДТП, пробках, погоде, курсах валют, биржевых котировках, спортивных результатах без аналитики.
4. Официальные комментарии Марии Захаровой: Если новость является прямым цитированием или пересказом её комментариев.
5. Сообщение без какого-либо контекста.

ВАЖНО: КРИТИЧЕСКИЕ ИСКЛЮЧЕНИЯ (не приводят к фильтрации):

1. МЕЖДУНАРОДНЫЕ ОТНОШЕНИЯ: 
   - Дипломатические переговоры, санкции, торговые соглашения
   - Внешняя политика стран (включая Китай, США, ЕС)
   - Международные экономические споры и конфликты

2. БИЗНЕС И ЭКОНОМИКА:
   - Деятельность компаний (включая китайские, американские, европейские)
   - Рыночные отношения, инвестиции, экспорт/импорт
   - Корпоративные конфликты и судебные разбирательства

3. КУЛЬТУРА И ИСКУССТВО:
   - Театральные постановки, фильмы, книги на любые темы (включая военные)
   - Художественные произведения, даже если затрагивают чувствительные темы
   - Обзоры и рецензии на произведения искусства

4. ОБЩЕСТВЕННО-ПОЛИТИЧЕСКАЯ АНАЛИТИКА:
   - Аналитические материалы о политике, экономике, обществе
   - Научные исследования и экспертные мнения
   - Образовательный и просветительский контент

5. НЕПРЯМЫЕ УПОМИНАНИЯ:
   - Краткие ссылки на страны, регионы, политиков в контексте основной темы
   - Фоновые исторические справки
   - Общие статистические данные без подробностей трагедий

ГЛАВНЫЙ ПРИНЦИП: Новость должна быть НЕПОСРЕДСТВЕННО И В ЯВНОМ ВИДЕ посвящена запретной теме. Если тема упоминается косвенно, контекстно или как часть более широкого обсуждения - фильтрация НЕ применяется.

ИНСТРУКЦИЯ К ДЕЙСТВИЮ И ФОРМАТ ОТВЕТА:

1. Если новость соответствует хотя бы одному критерию из разделов "Запретные темы" или "Дополнительные критерии", и это прямое и явное соответствие - в поле "filter" укажи false.
2. Если новость НЕ соответствует ни одному критерию, либо соответствие косвенное и подпадает под "Критические исключения" - в поле "filter" укажи true.
3. В поле "explain" кратко (1-2 предложения) объясни решение:
   - Если filter: false, укажи номер или суть нарушенного пункта.
   - Если filter: true, объясни, почему новость прошла фильтр.

Всегда отвечай в формате JSON:

{
  "filter": true,
  "explain": "Объяснение вашего решения."
}

"""

FILTER_INITIAL_SCHEMA: Dict[str, Any] = {
    "type": "object",
    "properties": {
        "filter": {
            "type": "boolean",
            "description": "Финальное решение: true (сообщение проходит фильтр) или false (сообщение не проходит фильтр) в соответствии с критериями FILTER_INITIAL."
        },
        "explain": {
            "type": "string",
            "description": "Краткое объяснение принятого решения (1-2 предложения), с указанием конкретного пункта нарушения, если filter=false."
        }
    },
    "required": ["filter", "explain"],
    "additionalProperties": False
}





# --- 2. ВТОРАЯ ФИЛЬТРАЦИЯ - убираем новости без контекста

CONTEXT_FILTRATION = """

Промпт для анализа контекста новости

Задача: Проанализируй текст новости и оцени каждый критерий по шкале от 0 до 10 баллов.

Шкала оценки:
- 10 = информация указана явно, однозначно и очевидна
- 7-9 = информация доступна, но с незначительными неясностями
- 5-6 = информация частично доступна, требуются допущения
- 3-4 = информация фрагментарна или сильно размыта
- 0-2 = информация отсутствует или крайне неясна

Критерии оценки:
1. subject (0-10): Насколько четко определены субъекты действия (конкретные люди/организации/группы)? Учитывай наличие имен, названий, должностей.
2. object (0-10): Насколько ясно указан объект или цель действия? Что является мишенью или получателем действия?
3. which (0-10): Насколько детально описаны субъекты/объекты (характеристики, статус, предыстория, квалификация)?
4. action (0-10): Насколько четко описано основное действие/событие? Однозначно ли понятно, что произошло?
5. time_place (0-10): Насколько конкретны указания времени (даты, периоды) и места (локации, адреса, регионы)?
6. how (0-10): Насколько хорошо объяснен метод/механизм действия? Каким способом было совершено действие?
7. reason (0-10): Насколько четко представлены мотивы/причины события? Что послужило триггером или основанием?
8. consequences (0-10): Насколько ясно описаны последствия/результаты? Какие изменения произошли вследствие события?

Инструкция:
1. Тщательно проанализируй текст новости по каждому критерию
2. Поставь оценку от 0 до 10 для каждого критерия
3. В поле context_explain напиши краткий анализ (2-3 предложения), выделив сильные и слабые стороны подачи информации

Формат ответа:
```json
{
  "subject_score": 8,
  "object_score": 7,
  "which_score": 6,
  "action_score": 9,
  "time_place_score": 5,
  "how_score": 6,
  "reason_score": 8,
  "consequences_score": 7,
  "context_explain": "Краткий анализ сильных и слабых сторон"
}

"""

CONTEXT_FILTRATION_SCHEMA: Dict[str, Any] = {
    "type": "object",
    "properties": {
        "subject_score": {
            "type": "number",
            "description": "Оценка четкости определения субъектов действия (0-10)"
        },
        "object_score": {
            "type": "number",
            "description": "Оценка ясности объекта или цели действия (0-10)"
        },
        "which_score": {
            "type": "number",
            "description": "Оценка детальности описания субъектов/объектов (0-10)"
        },
        "action_score": {
            "type": "number",
            "description": "Оценка четкости описания основного действия/события (0-10)"
        },
        "time_place_score": {
            "type": "number",
            "description": "Оценка конкретности указаний времени и места (0-10)"
        },
        "how_score": {
            "type": "number",
            "description": "Оценка объяснения метода/механизма действия (0-10)"
        },
        "reason_score": {
            "type": "number",
            "description": "Оценка представления мотивов/причин события (0-10)"
        },
        "consequences_score": {
            "type": "number",
            "description": "Оценка ясности описания последствий/результатов (0-10)"
        },
        "context_explain": {
            "type": "string",
            "description": "Краткий анализ сильных и слабых сторон подачи информации (2-3 предложения)"
        }
    },
    "required": [
        "subject_score",
        "object_score",
        "which_score",
        "action_score",
        "time_place_score",
        "how_score",
        "reason_score",
        "consequences_score",
        "context_explain"
    ],
    "additionalProperties": False
}

CONTEXT_THRESHOLD=6



# --- 3. ТРЕТЬЯ ФИЛЬТРАЦИЯ - фильтруем по сути

ESSENCE_FILTRATION = """

# ПРОМПТ ДЛЯ АНАЛИЗА ПОТЕНЦИАЛА НОВОСТИ

## ЗАДАЧА
Проанализируй новость и оцени её потенциал для создания художественного комментария по 10 ключевым критериям.

## КРИТЕРИИ АНАЛИЗА ПОТЕНЦИАЛА

### 1. ПОТЕНЦИАЛ ЭМОЦИОНАЛЬНОГО РАСКРЫТИЯ
**Возможности для создания эмоционального комментария:**
- 0-3: Минимальный потенциал для эмоциональной интерпретации
- 4-6: Есть базовые эмоциональные точки для развития
- 7-8: Богатая почва для создания сильного эмоционального отклика
- 9-10: Идеальный материал для глубокого эмоционального воздействия

### 2. ПОТЕНЦИАЛ ВИЗУАЛИЗАЦИИ  
**Возможности для создания ярких образов и метафор:**
- 0-3: Ограниченный потенциал для визуального представления
- 4-6: Позволяет создать стандартные визуальные образы
- 7-8: Дает основу для создания запоминающихся визуальных картин
- 9-10: Идеальный материал для создания мощных визуальных образов

### 3. ПОТЕНЦИАЛ РАСКРЫТИЯ ГЕРОЕВ
**Возможности для художественного осмысления персонажей:**
- 0-3: Герои не дают материала для художественного развития
- 4-6: Есть базовые характеристики для создания образов
- 7-8: Персонажи имеют потенциал для глубокого раскрытия
- 9-10: Идеальные герои для создания многогранных художественных образов

### 4. ПОТЕНЦИАЛ АКТУАЛИЗАЦИИ
**Возможности для связи с современными трендами и проблемами:**
- 0-3: Ограниченная возможность актуализации
- 4-6: Может быть увязана с некоторыми современными темами
- 7-8: Хорошо ложится в текущий общественный контекст
- 9-10: Идеально вписывается в актуальную повестку

### 5. ПОТЕНЦИАЛ ДРАМАТУРГИИ
**Возможности для создания напряженного повествования:**
- 0-3: Минимальный потенциал для драматического развития
- 4-6: Есть элементы для создания умеренного напряжения
- 7-8: Хорошая основа для построения драматической дуги
- 9-10: Идеальный материал для создания напряженного сюжета

### 6. ПОТЕНЦИАЛ КОНТЕКСТУАЛИЗАЦИИ
**Возможности для раскрытия системных проблем через историю:**
- 0-3: Ограниченный потенциал для контекстуального анализа
- 4-6: Позволяет показать некоторые системные связи
- 7-8: Дает хорошую основу для анализа системных проблем
- 9-10: Идеальный пример для раскрытия глубинных проблем общества

### 7. ПОТЕНЦИАЛ УНИВЕРСАЛИЗАЦИИ
**Возможности для придания истории общечеловеческого звучания:**
- 0-3: Трудно вывести на уровень универсальных тем
- 4-6: Позволяет затронуть некоторые общечеловеческие вопросы
- 7-8: Хорошо поддается универсальной интерпретации
- 9-10: Идеальный материал для раскрытия фундаментальных тем

### 8. ПОТЕНЦИАЛ СИМВОЛИЗАЦИИ
**Возможности для превращения в символ или архетип:**
- 0-3: Ограниченный потенциал для символического прочтения
- 4-6: Может стать примером определенного явления
- 7-8: Хорошо поддается символической интерпретации
- 9-10: Идеальный материал для создания мощного символа

### 9. ПОТЕНЦИАЛ ВИРАЛЬНОСТИ
**Возможности для создания вовлекающего контента:**
- 0-3: Ограниченный потенциал для вирального распространения
- 4-6: Может вызвать умеренный интерес у аудитории
- 7-8: Хорошая основа для создания вовлекающего контента
- 9-10: Идеальный материал для вирального распространения

### 10. ПОТЕНЦИАЛ СЮЖЕТНОГО РАЗВИТИЯ
**Возможности для построения нарратива и композиции:**
- 0-3: Минимальный потенциал для сюжетного развития
- 4-6: Позволяет создать базовую повествовательную структуру
- 7-8: Дает хорошую основу для построения сложного нарратива
- 9-10: Идеальный материал для создания многослойного сюжета с драматургической завершенностью

## МЕТОДОЛОГИЯ ОЦЕНКИ
- Оценивай не фактические характеристики новости, а её СКРЫТЫЙ ПОТЕНЦИАЛ
- Представляй, как можно развить тему в художественном комментарии
- Учитывай возможности для творческой интерпретации и развития
- Фокусируйся на том, что МОЖНО сделать с материалом, а не на том, что есть
- В поле essence_explain напиши краткие комментарий и оценки по всем критериям

## ФОРМАТ ОТВЕТА
```json
{
  "emotional_score": 8,
  "visual_score": 7,
  "heroes_score": 6,
  "actual_score": 9,
  "drama_score": 7,
  "context_depth_score": 8,
  "universal_score": 7,
  "symbolic_score": 6,
  "viral_score": 8,
  "narrative_score": 7,
  "essence_explain": "Эмоциональный потенциал (8/10): сухие факты скрывают драму человеческих отношений, что позволяет создать глубокий эмоциональный комментарий. Визуальный потенциал (7/10): есть возможности для создания метафор бюрократической системы и ярких образов. Потенциал героев (6/10): персонажи имеют базовые характеристики, но требуют дополнительной разработки. Актуальность (9/10): идеально вписывается в современную повестку. Драматургический потенциал (7/10): содержит элементы конфликта для построения напряженного повествования. Контекстуальный потенциал (8/10): позволяет раскрыть системные проблемы через частный случай. Универсальность (7/10): тема понятна разным социальным группам. Символический потенциал (6/10): может стать примером определенного явления. Виральный потенциал (8/10): хорошая основа для создания вовлекающего контента. Сюжетный потенциал (7/10): материал позволяет выстроить композицию с конфликтом и развязкой."
}

"""

ESSENCE_FILTRATION_SCHEMA: Dict[str, Any] = {
    "type": "object",
    "properties": {
        "emotional_score": {
            "type": "number",
            "description": "Оценка эмоциональной яркости новости (0-10)"
        },
        "visual_score": {
            "type": "number", 
            "description": "Оценка визуальной образности новости (0-10)"
        },
        "heroes_score": {
            "type": "number",
            "description": "Оценка интересности героев новости (0-10)"
        },
        "actual_score": {
            "type": "number",
            "description": "Оценка актуальности новости для жителя России (0-10)"
        },
        "drama_score": {
            "type": "number",
            "description": "Оценка драматичности новости (0-10)"
        },
        "context_depth_score": {
            "type": "number",
            "description": "Оценка глубины контекста новости (0-10)"
        },
        "universal_score": {
            "type": "number",
            "description": "Оценка универсальности темы новости (0-10)"
        },
        "symbolic_score": {
            "type": "number",
            "description": "Оценка символического значения новости (0-10)"
        },
        "viral_score": {
            "type": "number",
            "description": "Оценка вирального потенциала новости (0-10)"
        },
        "narrative_score": {
            "type": "number",
            "description": "Оценка социальной значимости новости (0-10)"
        },
        "essence_explain": {
            "type": "string", 
            "description": "Перечислить оценки по критериям и дать общее краткое пояснение (2-3 предложения)"
        }
    },
    "required": [
        "emotional_score",
        "visual_score", 
        "heroes_score",
        "actual_score",
        "drama_score",
        "context_depth_score",
        "universal_score",
        "symbolic_score",
        "viral_score",
        "narrative_score",
        "essence_explain"
    ],
    "additionalProperties": False
}

ESSENCE_THRESHOLD=8.0