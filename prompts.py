# Константы для промптов, используемых в запросах к Large Language Models (LLM).
from typing import Dict, Any




# --- 1. ПЕРВАЯ ФИЛЬТРАЦИЯ - убираем плохие темы

FILTER_INITIAL = """

Промпт для фильтрации новостей

Задача: Проанализируй текст новости и определи, нужно ли её фильтровать (отклонять) на основе строгих критериев.

КРИТЕРИИ ФИЛЬТРАЦИИ (ЗАПРЕТНЫЕ ТЕМЫ):

Если новость НЕПОСРЕДСТВЕННО И В ЯВНОМ ВИДЕ посвящена или подробно описывает хотя бы одну из следующих тем, она должна быть отклонена.

Категория А: Трагедии и насилие
1. Гибель людей или травмы: Конкретные репортажи о случаях с смертельным исходом или получением физических травм. Исключение: Общие статьи о мерах безопасности, успехах медицины без упоминания конкретных жертв.
2. Смерть или страдание животных: Новости о преднамеренном убийстве, жестоком обращении, мучениях или гибели животных. Исключение: Новости о защите прав животных или научных открытиях без описания страданий.
3. Совершение или подготовка террористического акта: Сообщения о конкретных совершенных, предотвращенных или готовящихся терактах. Исключение: Общая аналитика по борьбе с терроризмом без деталей конкретных инцидентов.
4. Изнасилование или покушение на изнасилование: Подробные отчеты о конкретных преступлениях или судебных процессах по ним.
5. Риск жизни или здоровью для уязвимых групп: Конкретные сообщения о ситуациях, где жизни детей, беременных, инвалидов или стариков угрожает непосредственная опасность.
6. Природные и техногенные катастрофы: Репортажи с мест катастроф (землетрясения, наводнения, аварии на производствах) с описанием разрушений, эвакуации и жертв.
7. Авиапроисшествия и ДТП с жертвами: Новости о конкретных инцидентах, где есть погибшие или раненые.

Категория Б: Военная тематика и последствия
8. Сводки о текущих боевых действиях: Оперативные отчеты с линии фронта, тактические описания боев.
9. Страдания мирного населения на войне: Репортажи о гибели, ранениях, лишениях и гуманитарных кризисах среди гражданского населения в зонах конфликтов.
10. Проблемы ветеранов со здоровьем: Подробные истории о тяжелых физических и психологических травмах (ПТСР, ампутации), полученных в ходе боевых действий.
11. Последствия атак с жертвами: Описание результатов ракетных, артиллерийских или иных атак с акцентом на человеческие жертвы и разрушения.
12. Атаки беспилотников (БПЛА, дроны): Новости о конкретных атаках с применением дронов, их последствиях или сбитии.
13. Военные диверсии и их последствия: Сообщения о подрывах, саботаже и их результатах.

Категория В: Социально-чувствительные темы
14. Аборты: Новости, напрямую посвященные практике абортов, законодательным изменениям по их регулированию или акциям за/против.
15. Чечня и семья Кадыровых: Новости, где Чеченская Республика ИЛИ члены семьи Кадыровых являются главной и центральной темой материала. Исключение: Краткие упоминания в контексте федеральной политики или экономики.
16. ЛГБТ-пропаганда: Материалы, открыто пропагандирующие или позитивно освещающие ЛГБТ-отношения и ценности. Исключение: Критические или нейтральные упоминания в контексте закона.
17. Педофилия и порнография: Репортажи о конкретных преступлениях сексуального характера против несовершеннолетних или материалы, связанные с детской порнографией.
18. Оскорбление религиозных чувств: Новости о конкретных актах осквернения религиозных символов, мест поклонения или издевательствах над верованиями.
19. Обманы мошенниками: Конкретные репортажи о случаях мошенничества с подробным описанием ущерба, особенно для пожилых. Исключение: Общие предупреждения от банков или силовых структур без деталей конкретного инцидента.

ДОПОЛНИТЕЛЬНЫЕ КРИТЕРИИ ФИЛЬТРАЦИИ (по формату и содержанию):

Даже если новость не попадает под запретные темы выше, отклони её, если она представляет собой:
1. Рекламные и маркетинговые материалы, откровенный пиар.
2. Дайджесты новостей (сводки из нескольких новостей).
3. Сухие информационные сводки: Краткие сообщения о ДТП, пробках, погоде, курсах валют, биржевых котировках, спортивных результатах без аналитики.
4. Официальные комментарии Марии Захаровой: Если новость является прямым цитированием или пересказом её комментариев.
5. Сообщение без какого-либо контекста.

ВАЖНО: КРИТИЧЕСКИЕ ИСКЛЮЧЕНИЯ (не приводят к фильтрации):

1. МЕЖДУНАРОДНЫЕ ОТНОШЕНИЯ: 
   - Дипломатические переговоры, санкции, торговые соглашения
   - Внешняя политика стран (включая Китай, США, ЕС)
   - Международные экономические споры и конфликты

2. БИЗНЕС И ЭКОНОМИКА:
   - Деятельность компаний (включая китайские, американские, европейские)
   - Рыночные отношения, инвестиции, экспорт/импорт
   - Корпоративные конфликты и судебные разбирательства

3. КУЛЬТУРА И ИСКУССТВО:
   - Театральные постановки, фильмы, книги на любые темы (включая военные)
   - Художественные произведения, даже если затрагивают чувствительные темы
   - Обзоры и рецензии на произведения искусства

4. ОБЩЕСТВЕННО-ПОЛИТИЧЕСКАЯ АНАЛИТИКА:
   - Аналитические материалы о политике, экономике, обществе
   - Научные исследования и экспертные мнения
   - Образовательный и просветительский контент

5. НЕПРЯМЫЕ УПОМИНАНИЯ:
   - Краткие ссылки на страны, регионы, политиков в контексте основной темы
   - Фоновые исторические справки
   - Общие статистические данные без подробностей трагедий

ГЛАВНЫЙ ПРИНЦИП: Новость должна быть НЕПОСРЕДСТВЕННО И В ЯВНОМ ВИДЕ посвящена запретной теме. Если тема упоминается косвенно, контекстно или как часть более широкого обсуждения - фильтрация НЕ применяется.

ИНСТРУКЦИЯ К ДЕЙСТВИЮ И ФОРМАТ ОТВЕТА:

1. Если новость соответствует хотя бы одному критерию из разделов "Запретные темы" или "Дополнительные критерии", и это прямое и явное соответствие - в поле "filter" укажи false.
2. Если новость НЕ соответствует ни одному критерию, либо соответствие косвенное и подпадает под "Критические исключения" - в поле "filter" укажи true.
3. В поле "explain" кратко (1-2 предложения) объясни решение:
   - Если filter: false, укажи номер или суть нарушенного пункта.
   - Если filter: true, объясни, почему новость прошла фильтр.

Всегда отвечай в формате JSON:

{
  "filter": true,
  "explain": "Объяснение вашего решения."
}

"""

FILTER_INITIAL_SCHEMA: Dict[str, Any] = {
    "type": "object",
    "properties": {
        "filter": {
            "type": "boolean",
            "description": "Финальное решение: true (сообщение проходит фильтр) или false (сообщение не проходит фильтр) в соответствии с критериями FILTER_INITIAL."
        },
        "explain": {
            "type": "string",
            "description": "Краткое объяснение принятого решения (1-2 предложения), с указанием конкретного пункта нарушения, если filter=false."
        }
    },
    "required": ["filter", "explain"],
    "additionalProperties": False
}





# --- 2. ВТОРАЯ ФИЛЬТРАЦИЯ - убираем новости без контекста

CONTEXT_FILTRATION = """

Промпт для анализа контекста новости

Задача: Проанализируй текст новости и оцени каждый критерий по шкале от 0 до 10 баллов.

Шкала оценки:
- 10 = информация указана явно, однозначно и очевидна
- 7-9 = информация доступна, но с незначительными неясностями
- 5-6 = информация частично доступна, требуются допущения
- 3-4 = информация фрагментарна или сильно размыта
- 0-2 = информация отсутствует или крайне неясна

Критерии оценки:
1. subject (0-10): Насколько четко определены субъекты действия (конкретные люди/организации/группы)? Учитывай наличие имен, названий, должностей.
2. object (0-10): Насколько ясно указан объект или цель действия? Что является мишенью или получателем действия?
3. which (0-10): Насколько детально описаны субъекты/объекты (характеристики, статус, предыстория, квалификация)?
4. action (0-10): Насколько четко описано основное действие/событие? Однозначно ли понятно, что произошло?
5. time_place (0-10): Насколько конкретны указания времени (даты, периоды) и места (локации, адреса, регионы)?
6. how (0-10): Насколько хорошо объяснен метод/механизм действия? Каким способом было совершено действие?
7. reason (0-10): Насколько четко представлены мотивы/причины события? Что послужило триггером или основанием?
8. consequences (0-10): Насколько ясно описаны последствия/результаты? Какие изменения произошли вследствие события?

Инструкция:
1. Тщательно проанализируй текст новости по каждому критерию
2. Поставь оценку от 0 до 10 для каждого критерия
3. В поле context_explain напиши краткий анализ (2-3 предложения), выделив сильные и слабые стороны подачи информации

Формат ответа:
```json
{
  "subject_score": 8,
  "object_score": 7,
  "which_score": 6,
  "action_score": 9,
  "time_place_score": 5,
  "how_score": 6,
  "reason_score": 8,
  "consequences_score": 7,
  "context_explain": "Краткий анализ сильных и слабых сторон"
}

"""

CONTEXT_FILTRATION_SCHEMA: Dict[str, Any] = {
    "type": "object",
    "properties": {
        "subject_score": {
            "type": "number",
            "description": "Оценка четкости определения субъектов действия (0-10)"
        },
        "object_score": {
            "type": "number",
            "description": "Оценка ясности объекта или цели действия (0-10)"
        },
        "which_score": {
            "type": "number",
            "description": "Оценка детальности описания субъектов/объектов (0-10)"
        },
        "action_score": {
            "type": "number",
            "description": "Оценка четкости описания основного действия/события (0-10)"
        },
        "time_place_score": {
            "type": "number",
            "description": "Оценка конкретности указаний времени и места (0-10)"
        },
        "how_score": {
            "type": "number",
            "description": "Оценка объяснения метода/механизма действия (0-10)"
        },
        "reason_score": {
            "type": "number",
            "description": "Оценка представления мотивов/причин события (0-10)"
        },
        "consequences_score": {
            "type": "number",
            "description": "Оценка ясности описания последствий/результатов (0-10)"
        },
        "context_explain": {
            "type": "string",
            "description": "Краткий анализ сильных и слабых сторон подачи информации (2-3 предложения)"
        }
    },
    "required": [
        "subject_score",
        "object_score",
        "which_score",
        "action_score",
        "time_place_score",
        "how_score",
        "reason_score",
        "consequences_score",
        "context_explain"
    ],
    "additionalProperties": False
}

CONTEXT_THRESHOLD=6



# --- 3. ТРЕТЬЯ ФИЛЬТРАЦИЯ - фильтруем по сути

ESSENCE_FILTRATION = """
Задача: Проанализируй новость и оцени ее по 5 ключевым критериям. Рассчитай среднюю оценку и дай сводное пояснение.

КРИТЕРИИ ОЦЕНКИ:

1. ЭМОЦИОНАЛЬНАЯ ЯРКОСТЬ
Оцени степень эмоциональной яркости новости:

Шкала:
0 баллов — Абсолютно без эмоций: Сухие факты, статистика, технические данные
1 балл — Почти нет эмоций: Формальные объявления, бюрократические решения
2 балла — Минимальная эмоция: Едва заметный эмоциональный оттенок
3 балла — Слабая эмоция: Легкий эмоциональный отклик, но без выразительности
4 балла — Умеренная эмоция: Чувства присутствуют, но предсказуемы и стандартны
5 баллов — Заметная эмоция: Вызывает определенную эмоциональную реакцию
6 баллов — Яркая эмоция: Вызывает смех, удивление, легкое возмущение или умиление
7 баллов — Выраженная эмоция: Сильный эмоциональный отклик, запоминается
8 баллов — Сильная эмоция: Громкий повод для обсуждения, провоцирует живую реакцию
9 баллов — Очень сильная эмоция: Вызывает бурные обсуждения, эмоционально заряжена
10 баллов — Взрывная эмоция: Новость, которую все будут обсуждать из-за абсурдности, трогательности или эпичности

Ищем эмоции: радость, восторг, умиление, удивление, возмущение, ирония, сатира, драматизм, смешанные эмоции, чувство неловкости.

2. ВИЗУАЛЬНАЯ ОБРАЗНОСТЬ
Оцени степень визуальной образности новости:

Шкала:
0 баллов — Абсолютно нет образов: Абстрактные данные, цифры, формулы
1 балл — Почти нет образов: Технические описания без визуальных элементов
2 балла — Минимальная образность: Есть упоминания объектов, но без деталей
3 балла — Слабая образность: Базовые описания, стандартные образы
4 балла — Умеренная образность: Узнаваемые символы, но без выразительных деталей
5 баллов — Заметная образность: Есть конкретные визуальные элементы
6 баллов — Яркая образность: Запоминающаяся сцена с деталями
7 баллов — Выраженная образность: Яркие визуальные образы, легко представить
8 баллов — Сильная образность: Кинематографичность - готовый эпизод для фильма
9 баллов — Очень сильная образность: Живые, детализированные визуальные картины
10 баллов — Шедевр абсурда: Образ настолько силён, что становится мемом, мгновенно визуализируется

3. ИНТЕРЕСНОСТЬ ГЕРОЕВ
Оцени, насколько герои новости могут быть интересны читателю:

Шкала:
0 баллов — Абсолютно неинтересен: Анонимный источник, случайный человек без контекста
1 балл — Почти неинтересен: Безликий участник событий
2 балла — Минимальная интересность: Упоминание человека без характеристик
3 балла — Слабая интересность: Обычный человек без особенностей
4 балла — Умеренная интересность: Человек с базовой характеристикой или ролью
5 баллов — Заметная интересность: Личность с определенными качествами или позицией
6 баллов — Яркая интересность: Известный герой или необычная история
7 баллов — Выраженная интересность: Персона с уникальными характеристиками
8 баллов — Сильная интересность: Медийная персона с интересной историей
9 баллов — Очень сильная интересность: Известная личность с яркой историей
10 баллов — Максимально интересен: Персона, чьи действия/слова могут повлиять на многих, ключевая фигура

4. АКТУАЛЬНОСТЬ
Оцени, насколько новость актуальна для среднего жителя России:

Шкала:
0 баллов — Абсолютно неактуально: Узкоспециализированная тема без общественного значения
1 балл — Почти неактуально: Очень локальное или нишевое событие
2 балла — Минимальная актуальность: Локальное событие без глубокого смысла
3 балла — Слабая актуальность: Событие с ограниченной значимостью
4 балла — Умеренная актуальность: Событие, отражающее отдельные современные тренды
5 баллов — Заметная актуальность: Касается определенных социальных групп
6 баллов — Яркая актуальность: Затрагивает важные социальные темы
7 баллов — Выраженная актуальность: Значимое событие для общества
8 баллов — Сильная актуальность: Отражает ключевые проблемы общества
9 баллов — Очень сильная актуальность: Событие с широкими последствиями
10 баллов — Максимальная актуальность: Событие, определяющее современную повестку, затрагивает большинство

5. ДРАМАТИЧНОСТЬ
Оцени степень драмы в новости:

Шкала:
0 баллов — Абсолютно нет драмы: Рутинные процессы, стандартные операции
1 балл — Почти нет драмы: Минимальное напряжение или конфликт
2 балла — Минимальная драма: Легкое противостояние или небольшие трудности
3 балла — Слабая драма: Наличие конфликта, но без остроты
4 балла — Умеренная драма: Заметное противостояние или ощутимые трудности
5 баллов — Заметная драма: Выраженный конфликт или эмоциональное напряжение
6 баллов — Яркая драма: Эмоциональный сюжет с неожиданным поворотом
7 баллов — Выраженная драма: Сильное напряжение, глубокие переживания
8 баллов — Сильная драма: Глубокий конфликт или трогательная история
9 баллов — Очень сильная драма: Интенсивная драма с высокими ставками
10 баллов — Граница допустимого: Почти трагедия, но без необратимых последствий, максимальное напряжение

6. ГЛУБИНА КОНТЕКСТА
Оцени, насколько новость раскрывает системные проблемы, а не просто констатирует факты:

Шкала:
0 баллов — Без контекста: Констатация фактов без анализа причин и последствий
1 балл — Минимальный контекст: Есть упоминание общих причин, но без деталей
2 балла — Поверхностный контекст: Базовое объяснение ситуации
3 балла — Ограниченный контекст: Некоторые причинно-следственные связи
4 балла — Умеренный контекст: Достаточное объяснение ситуации с примерами
5 баллов — Развернутый контекст: Хорошо проработанные причинно-следственные связи
6 баллов — Глубокий контекст: Анализ системных проблем на основе конкретной истории
7 баллов — Многослойный контекст: Рассмотрение проблемы с разных сторон
8 баллов — Системный контекст: Показывает как личная история отражает общественные тенденции
9 баллов — Комплексный контекст: Глубокий анализ взаимосвязей и долгосрочных последствий
10 баллов — Фундаментальный контекст: Раскрывает коренные проблемы общества через конкретный случай

7. УНИВЕРСАЛЬНОСТЬ ТЕМЫ
Оцени, насколько тема новости понятна и близка людям разных возрастов, профессий и социальных групп:

Шкала:
0 баллов — Узкоспециализированная: Понятна только экспертам в конкретной области
1 балл — Очень нишевая: Интересна узкой группе людей
2 балла — Специфическая: В основном интересна определенному кругу
3 балла — Ограниченная аудитория: Понятна нескольким социальным группам
4 балла — Широкая внутри групп: Интересна разным людям внутри крупных категорий
5 баллов — Межгрупповая: Находит отклик у людей из разных социальных слоев
6 баллов — Общедоступная: Понятна большинству взрослых людей
7 баллов — Межпоколенческая: Интересна и молодым, и пожилым
8 баллов — Универсальная: Затрагивает базовые человеческие ценности и потребности
9 баллов — Глубоко универсальная: Касается фундаментальных вопросов человеческого существования
10 баллов — Абсолютно универсальная: Понятна и близка любому человеку независимо от背景

8. СИМВОЛИЧЕСКОЕ ЗНАЧЕНИЕ
Оцени, насколько новость может стать символом более крупных тенденций или проблем в обществе:

Шкала:
0 баллов — Без символики: Конкретный случай без переносного значения
1 балл — Минимальная символика: Едва уловимая связь с общими тенденциями
2 балла — Слабая символика: Некоторые параллели с более широкими явлениями
3 балла — Умеренная символика: Прослеживается связь с общественными процессами
4 балла — Заметная символика: Может служить примером определенного явления
5 баллов — Выраженная символика: Ясно представляет более крупную проблему
6 баллов — Яркая символика: Становится типичным примером социального явления
7 баллов — Сильная символика: Четко олицетворяет значимую общественную тенденцию
8 баллов — Глубокая символика: Раскрывает суть важных социальных изменений
9 баллов — Многогранная символика: Служит символом нескольких взаимосвязанных проблем
10 баллов — Знаковая символика: Может стать культурным или социальным маркером эпохи

9. ВИРАЛЬНЫЙ ПОТЕНЦИАЛ
Оцени, насколько новость может стать виральной и вызвать желание поделиться:

Шкала:
0 баллов — Невозможно стать виральной: Слишком скучная или специализированная
1 балл — Крайне низкий потенциал: Маловероятно, что кто-то захочет поделиться
2 балла — Очень низкий потенциал: Могут поделиться только непосредственные участники
3 балла — Низкий потенциал: Интересна узкому кругу заинтересованных
4 балла — Умеренный потенциал: Может распространяться в профессиональных сообществах
5 баллов — Заметный потенциал: Вызывает желание поделиться у значительной части аудитории
6 баллов — Высокий потенциал: Легко распространяется в социальных сетях
7 баллов — Очень высокий потенциал: Сильный импульс к распространению
8 баллов — Отличный потенциал: Идеально подходит для вирального распространения
9 баллов — Исключительный потенциал: Обречена стать виральной
10 баллов — Абсолютный виральный хит: Становится мемом или интернет-феноменом

10. СОЦИАЛЬНАЯ ЗНАЧИМОСТЬ
Оцени, насколько новость затрагивает важные общественные проблемы и может повлиять на общество:

Шкала:
0 баллов — Без социальной значимости: Не затрагивает общественные проблемы
1 балл — Минимальная значимость: Косвенно касается социальных вопросов
2 балла — Небольшая значимость: Затрагивает малозначимые общественные аспекты
3 балла — Ограниченная значимость: Касается локальных социальных проблем
4 балла — Умеренная значимость: Затрагивает заметные общественные вопросы
5 баллов — Заметная значимость: Поднимает важные социальные темы
6 баллов — Высокая значимость: Может повлиять на общественное мнение
7 баллов — Очень высокая значимость: Способна изменить отношение к проблеме
8 баллов — Существенная значимость: Может привести к общественным изменениям
9 баллов — Критическая значимость: Затрагивает фундаментальные основы общества
10 баллов — Историческая значимость: Может стать поворотным моментом в общественном сознании

ИНСТРУКЦИЯ:
1. Оцени каждый критерий по шкале от 0 до 10
2. В пояснении укажи оценки всех критериев и дай общие краткие пояснения к анализу

ФОРМАТ ОТВЕТА:
Всегда отвечай в формате JSON:

```json
{
  "emotional_score": 8,
  "visual_score": 5,
  "heroes_score": 7,
  "actual_score": 9,
  "drama_score": 6,
  "context_depth_score": 7,
  "universal_score": 8,
  "symbolic_score": 6,
  "viral_score": 5,
  "social_score": 7,
  "essence_explain": "Эмоциональность: 8/10 (вызывает сочувствие и возмущение), Визуальность: 5/10 (стандартное описание), Герои: 7/10 (обычные люди в сложной ситуации), Актуальность: 9/10 (затрагивает проблему ЖКХ), Драматичность: 6/10 (конфликт с управляющей компанией), Глубина контекста: 7/10 (показывает системные проблемы ЖКХ), Универсальность: 8/10 (тема жилья близка всем), Символическое значение: 6/10 (типичная ситуация для многих городов), Виральный потенциал: 5/10 (может вызвать обсуждение в локальных чатах), Социальная значимость: 7/10 (поднимает важную общественную проблему). Новость имеет хороший потенциал благодаря актуальности темы и универсальности проблемы."
}

"""

ESSENCE_FILTRATION_SCHEMA: Dict[str, Any] = {
    "type": "object",
    "properties": {
        "emotional_score": {
            "type": "number",
            "description": "Оценка эмоциональной яркости новости (0-10)"
        },
        "visual_score": {
            "type": "number", 
            "description": "Оценка визуальной образности новости (0-10)"
        },
        "heroes_score": {
            "type": "number",
            "description": "Оценка интересности героев новости (0-10)"
        },
        "actual_score": {
            "type": "number",
            "description": "Оценка актуальности новости для жителя России (0-10)"
        },
        "drama_score": {
            "type": "number",
            "description": "Оценка драматичности новости (0-10)"
        },
        "context_depth_score": {
            "type": "number",
            "description": "Оценка глубины контекста новости (0-10)"
        },
        "universal_score": {
            "type": "number",
            "description": "Оценка универсальности темы новости (0-10)"
        },
        "symbolic_score": {
            "type": "number",
            "description": "Оценка символического значения новости (0-10)"
        },
        "viral_score": {
            "type": "number",
            "description": "Оценка вирального потенциала новости (0-10)"
        },
        "social_score": {
            "type": "number",
            "description": "Оценка социальной значимости новости (0-10)"
        },
        "essence_explain": {
            "type": "string", 
            "description": "Перечислить оценки по критериям и дать общее краткое пояснение (2-3 предложения)"
        }
    },
    "required": [
        "emotional_score",
        "visual_score", 
        "heroes_score",
        "actual_score",
        "drama_score",
        "context_depth_score",
        "universal_score",
        "symbolic_score",
        "viral_score",
        "social_score",
        "essence_explain"
    ],
    "additionalProperties": False
}

ESSENCE_THRESHOLD=7.0
ESSENCE_MAX=9.0